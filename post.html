<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title id="meta-title">Đang tải bài viết...</title>
    <meta id="meta-desc" name="description" content="">
    <meta property="og:type" content="article" />
    <meta property="og:title" id="og-title" content="" />
    <meta property="og:image" id="og-image" content="" />
    <meta property="og:description" id="og-desc" content="" />

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        body { background-color: #f3f4f6; font-family: 'Inter', sans-serif; }
        .post-content img { border-radius: 0.75rem; margin: 1.5rem 0; width: 100%; }
        .post-content p { margin-bottom: 1.25rem; line-height: 1.75; color: #374151; font-size: 1.1rem; }
        .btn-reaction { transition: all 0.2s ease; }
        .btn-reaction:active { transform: scale(0.9); }
    </style>
</head>
<body>

    <nav class="bg-white border-b sticky top-0 z-50">
        <div class="max-w-5xl mx-auto px-4 h-16 flex items-center justify-between">
            <a href="index.html" class="text-2xl font-bold text-blue-600">MyBlog</a>
            <div class="space-x-4 text-gray-600">
                <a href="#" class="hover:text-blue-500">Trang chủ</a>
                <a href="#" class="hover:text-blue-500">Danh mục</a>
            </div>
        </div>
    </nav>

    <div class="max-w-4xl mx-auto px-4 py-10">
        <article class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
            <img id="post-image" src="" alt="" class="w-full h-[400px] object-cover">

            <div class="p-8 md:p-12">
                <div class="mb-6">
                    <h1 id="post-title" class="text-3xl md:text-5xl font-extrabold text-gray-900 leading-tight mb-4"></h1>
                    <div class="flex items-center text-gray-500 space-x-4 text-sm">
                        <span class="flex items-center"><i class="far fa-user mr-2"></i> <b id="post-author" class="text-gray-800"></b></span>
                        <span class="flex items-center"><i class="far fa-calendar mr-2"></i> <span id="post-date"></span></span>
                    </div>
                </div>

                <div id="post-content" class="post-content border-t pt-8">
                    </div>

                <div class="mt-12 pt-8 border-t flex flex-col md:flex-row md:items-center justify-between gap-6">
                    <div class="flex items-center space-x-8">
                        <div class="flex flex-col items-center">
                            <button onclick="updateReaction('likes')" class="btn-reaction w-14 h-14 rounded-full bg-blue-50 text-blue-600 hover:bg-blue-100 flex items-center justify-center text-xl shadow-sm">
                                <i class="fas fa-thumbs-up"></i>
                            </button>
                            <span id="count-likes" class="mt-2 font-bold text-gray-700">0</span>
                        </div>
                        
                        <div class="flex flex-col items-center">
                            <button onclick="updateReaction('dislikes')" class="btn-reaction w-14 h-14 rounded-full bg-red-50 text-red-600 hover:bg-red-100 flex items-center justify-center text-xl shadow-sm">
                                <i class="fas fa-thumbs-down"></i>
                            </button>
                            <span id="count-dislikes" class="mt-2 font-bold text-gray-700">0</span>
                        </div>
                    </div>

                    <button onclick="shareFacebook()" class="flex items-center bg-[#1877F2] text-white px-8 py-3 rounded-xl hover:bg-blue-700 transition-all font-semibold shadow-md">
                        <i class="fab fa-facebook-f mr-3 text-lg"></i> Chia sẻ lên Facebook
                    </button>
                </div>
            </div>
        </article>
    </div>

    <script>
        // 1. Lấy ID bài viết từ URL (?id=1)
        const urlParams = new URLSearchParams(window.location.search);
        const postId = parseInt(urlParams.get('id'));

        // 2. Tải dữ liệu từ file JSON
        fetch('posts_data.json')
            .then(response => response.json())
            .then(posts => {
                const post = posts.find(p => p.id === postId);
                
                if (post) {
                    renderPost(post);
                } else {
                    document.body.innerHTML = "<h1 class='text-center mt-20'>Không tìm thấy bài viết!</h1>";
                }
            })
            .catch(err => console.error("Lỗi tải dữ liệu:", err));

        // 3. Hiển thị dữ liệu lên giao diện
        function renderPost(post) {
            // Hiển thị nội dung
            document.getElementById('post-title').innerText = post.title;
            document.getElementById('post-author').innerText = post.author;
            document.getElementById('post-date').innerText = post.date;
            document.getElementById('post-content').innerHTML = post.content;
            document.getElementById('post-image').src = post.image;
            document.getElementById('count-likes').innerText = post.likes;
            document.getElementById('count-dislikes').innerText = post.dislikes;

            // Cập nhật Meta Tags cho Facebook
            document.getElementById('meta-title').innerText = post.title;
            document.getElementById('og-title').setAttribute("content", post.title);
            document.getElementById('og-image').setAttribute("content", window.location.origin + "/" + post.image);
            document.getElementById('og-desc').setAttribute("content", post.content.substring(0, 160) + "...");
        }

        // 4. Hàm xử lý Chia sẻ Facebook
        function shareFacebook() {
            const url = window.location.href;
            window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`, 'facebook-share-dialog', 'width=600,height=400');
        }

        // 5. Hàm xử lý Like/Dislike (Giao diện người dùng)
        function updateReaction(type) {
            const elem = document.getElementById(`count-${type}`);
            let currentCount = parseInt(elem.innerText);
            elem.innerText = currentCount + 1;
            
            // Lưu ý: Để lưu vĩnh viễn, bạn cần kết nối với Database hoặc dùng LocalStorage cho demo:
            alert(`Bạn đã ${type === 'likes' ? 'Thích' : 'Không thích'} bài viết này!`);
        }
    </script>
</body>
</html>